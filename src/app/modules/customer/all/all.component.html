<form nz-form [formGroup]="queryForm">
  <div nz-row [nzGutter]="30">
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label [attr.for]="'babyName'">宝宝姓名</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-input nzSize="large" nzPlaceHolder="请输入宝宝姓名" formControlName="babyName" nzId="babyName"></nz-input>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>跟进状态</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-select nzSize="large" formControlName="followStage" nzPlaceHolder="请选择跟进状态" nzAllowClear>
            <nz-option nzLabel="进行中" [nzValue]="1"></nz-option>
            <nz-option nzLabel="已暂停" [nzValue]="2"></nz-option>
            <nz-option nzLabel="已关闭" [nzValue]="3"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>来源</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-select nzSize="large" formControlName="source" nzPlaceHolder="请选择客户来源" nzAllowClear>
            <nz-option nzLabel="今日头条" [nzValue]="1"></nz-option>
            <nz-option nzLabel="腾讯新闻" [nzValue]="2"></nz-option>
            <nz-option nzLabel="微信小程序" [nzValue]="3"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label [attr.for]="'parentName'">家长姓名</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-input nzSize="large" nzPlaceHolder="请输入家长姓名" formControlName="parentName" nzId="parentName"></nz-input>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label [attr.for]="'mobilePhone'">家长电话</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-input nzSize="large" nzPlaceHolder="请输入家长电话" formControlName="mobilePhone" nzId="mobilePhone"></nz-input>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>宝宝性别</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-select nzSize="large" formControlName="sex" nzPlaceHolder="请选择宝宝性别" nzAllowClear>
            <nz-option nzLabel="男" [nzValue]="1"></nz-option>
            <nz-option nzLabel="女" [nzValue]="2"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>宝宝生日</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-rangepicker nzSize="large" formControlName="babyBirthdayEnd" [nzPlaceholder]="['开始日期', '结束日期']"></nz-rangepicker>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>创建日期</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-rangepicker nzSize="large" formControlName="createDateEnd" [nzPlaceholder]="['开始日期', '结束日期']"></nz-rangepicker>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>下次跟进</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-rangepicker nzSize="large" formControlName="nextFollowTimeEnd" [nzPlaceholder]="['开始日期', '结束日期']"></nz-rangepicker>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>最后跟进</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-rangepicker nzSize="large" formControlName="lastFollowTimeEnd" [nzPlaceholder]="['开始日期', '结束日期']"></nz-rangepicker>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>负责销售</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-select nzSize="large" formControlName="followSeller" nzPlaceHolder="请选择负责销售" nzAllowClear>
            <nz-option nzLabel="黄埔" [nzValue]="1"></nz-option>
            <nz-option nzLabel="赵鹏" [nzValue]="2"></nz-option>
            <nz-option nzLabel="晶晶" [nzValue]="3"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>收集者</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-select nzSize="large" formControlName="collector" nzPlaceHolder="请选择收集者" nzAllowClear>
            <nz-option nzLabel="黄埔" [nzValue]="1"></nz-option>
            <nz-option nzLabel="赵鹏" [nzValue]="2"></nz-option>
            <nz-option nzLabel="晶晶" [nzValue]="3"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
    <div nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.display]="isCollapse ? 'none' : 'block'">
      <div nz-form-item nz-row>
        <div nz-form-label nz-col [nzSpan]="5">
          <label>推荐人</label>
        </div>
        <div nz-form-control nz-col [nzSpan]="19">
          <nz-select nzSize="large" formControlName="recommended" nzPlaceHolder="请选择推荐人" nzAllowClear>
            <nz-option nzLabel="黄埔" [nzValue]="1"></nz-option>
            <nz-option nzLabel="赵鹏" [nzValue]="2"></nz-option>
            <nz-option nzLabel="晶晶" [nzValue]="3"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
    <div nz-form-item nz-col [nzXl]="6" [nzLg]="8" [nzSm]="12" [nzXs]="24" [style.width]="isCollapse ? '' : '100%'" [style.text-align]="isCollapse ? 'left' : 'right'">
      <button nz-button nzSize="large" [nzType]="'primary'" (click)="_query()">查询</button>
      <button nz-button nzSize="large" (click)="_reset()" style="margin-left: 8px;">重置</button>
      <a style="margin-left:8px;font-size:12px;" (click)="isCollapse = !isCollapse">
        {{ isCollapse ? '展开' : '收起' }}
        <i class="anticon" [class.anticon-down]="isCollapse" [class.anticon-up]="!isCollapse"></i>
      </a>
    </div>
  </div>
</form>

<cm-alert type="info" [showClose]="true" (onClose)="tapClose()">选择 <a href="javascript: void(0)">4条</a> 相关记录</cm-alert>


<nz-table #nzTable 
  [nzAjaxData]="dataSet" 
  [nzShowSizeChanger]="true" 
  [nzLoading]="queryPages.loading" 
  [nzTotal]="queryPages.total"
  [(nzPageIndex)]="queryPages.pageNum" 
  (nzPageIndexChange)="_query()" 
  [(nzPageSize)]="queryPages.pageSize" 
  (nzPageSizeChange)="_query(true)">
  <thead nz-thead>
    <tr>
      <th nz-th [nzExpand]="true" nzWidth="50px"></th>
      <th nz-th nzWidth="80px">
        <span>宝宝昵称</span>
      </th>
      <th nz-th nzWidth="60px">
        <span>性别</span>
      </th>
      <th nz-th nzWidth="60px">
        <span>月龄</span>
      </th>
      <th nz-th nzWidth="80px">
        <span>家长姓名</span>
      </th>
      <th nz-th nzWidth="100px">
        <span>家长电话</span>
      </th>
      <th nz-th nzWidth="120px">
        <span>创建时间</span>
      </th>
      <th nz-th nzWidth="60px">
        <span>操作</span>
      </th>
    </tr>
  </thead>
  <tbody nz-tbody>
    <ng-template ngFor let-data [ngForOf]="nzTable.data">
      <tr nz-tbody-tr>
        <td nz-td [nzExpand]="true">
          <nz-row-expand-icon [(nzExpand)]="data.expand"></nz-row-expand-icon>
        </td>
        <td nz-td>
          <a href="javascript: void(0);" (click)="getPhone(data)" [hidden]="data.checkPhone">查看电话</a>
          {{ data.checkPhone ? data.checkPhone : ''}}
        </td>
        <td nz-td>{{data.secondName}}</td>
        <td nz-td>{{data.customerSpreadRelationId}}</td>
        <td nz-td>{{data.province + data.city + data.area}}</td>
        <td nz-td>{{data.shopName}}</td>
        <td nz-td>{{data.preStartDate}}</td>
        <td nz-td>
          <a href="javascript: void(0);" (click)="updateCustomerInfo(data)">预约</a>
        </td>
      </tr>
      <tr nz-tbody-tr *ngIf="data.expand" class="ui-table-expand">
        <td nz-td></td>
        <td nz-td colspan="10">
          <div class="expand-box">
            <div nz-col [nzSpan]="12">
              <label nz-col [nzSpan]="8">填写时间</label>
              <div nz-col [nzSpan]="16">2017-11-09 23:12:01</div>
            </div>
            <div nz-col [nzSpan]="12">
              <label nz-col [nzSpan]="8">活动价格</label>
              <div nz-col [nzSpan]="16">¥12.05</div>
            </div>
            <div nz-col [nzSpan]="24">
              <label nz-col [nzSpan]="4">备注</label>
              <div nz-col [nzSpan]="20">多放辣椒多放醋, 多放辣椒多放醋, 多放辣椒多放醋</div>
            </div>
          </div>
        </td>
      </tr>
    </ng-template>
  </tbody>
</nz-table>